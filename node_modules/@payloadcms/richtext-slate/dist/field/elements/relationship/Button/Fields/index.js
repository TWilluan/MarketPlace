'use client';
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "default", {
    enumerable: true,
    get: function() {
        return _default;
    }
});
const _Relationship = require("payload/components/fields/Relationship");
const _Select = require("payload/components/fields/Select");
const _forms = require("payload/components/forms");
const _utilities = require("payload/components/utilities");
const _react = /*#__PURE__*/ _interop_require_wildcard(require("react"));
const _reacti18next = require("react-i18next");
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
const createOptions = (collections, permissions)=>collections.reduce((options, collection)=>{
        if (permissions?.collections?.[collection.slug]?.read?.permission && collection?.admin?.enableRichTextRelationship) {
            return [
                ...options,
                {
                    label: collection.labels.plural,
                    value: collection.slug
                }
            ];
        }
        return options;
    }, []);
const RelationshipFields = ()=>{
    const { collections } = (0, _utilities.useConfig)();
    const { permissions } = (0, _utilities.useAuth)();
    const { t } = (0, _reacti18next.useTranslation)('fields');
    const [options, setOptions] = (0, _react.useState)(()=>createOptions(collections, permissions));
    const relationTo = (0, _forms.useFormFields)(([fields])=>fields.relationTo?.value);
    (0, _react.useEffect)(()=>{
        setOptions(createOptions(collections, permissions));
    }, [
        collections,
        permissions
    ]);
    return /*#__PURE__*/ _react.default.createElement(_react.Fragment, null, /*#__PURE__*/ _react.default.createElement(_Select.SelectComponent, {
        label: t('relationTo'),
        name: "relationTo",
        options: options,
        required: true
    }), relationTo && /*#__PURE__*/ _react.default.createElement(_Relationship.RelationshipComponent, {
        label: t('relatedDocument'),
        name: "value",
        relationTo: relationTo,
        required: true
    }));
};
const _default = RelationshipFields;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3NyYy9maWVsZC9lbGVtZW50cy9yZWxhdGlvbnNoaXAvQnV0dG9uL0ZpZWxkcy9pbmRleC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBjbGllbnQnXG5cbmltcG9ydCB7IFJlbGF0aW9uc2hpcENvbXBvbmVudCB9IGZyb20gJ3BheWxvYWQvY29tcG9uZW50cy9maWVsZHMvUmVsYXRpb25zaGlwJ1xuaW1wb3J0IHsgU2VsZWN0Q29tcG9uZW50IH0gZnJvbSAncGF5bG9hZC9jb21wb25lbnRzL2ZpZWxkcy9TZWxlY3QnXG5pbXBvcnQgeyB1c2VGb3JtRmllbGRzIH0gZnJvbSAncGF5bG9hZC9jb21wb25lbnRzL2Zvcm1zJ1xuaW1wb3J0IHsgdXNlQXV0aCwgdXNlQ29uZmlnIH0gZnJvbSAncGF5bG9hZC9jb21wb25lbnRzL3V0aWxpdGllcydcbmltcG9ydCBSZWFjdCwgeyBGcmFnbWVudCwgdXNlRWZmZWN0LCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IHsgdXNlVHJhbnNsYXRpb24gfSBmcm9tICdyZWFjdC1pMThuZXh0J1xuXG5jb25zdCBjcmVhdGVPcHRpb25zID0gKGNvbGxlY3Rpb25zLCBwZXJtaXNzaW9ucykgPT5cbiAgY29sbGVjdGlvbnMucmVkdWNlKChvcHRpb25zLCBjb2xsZWN0aW9uKSA9PiB7XG4gICAgaWYgKFxuICAgICAgcGVybWlzc2lvbnM/LmNvbGxlY3Rpb25zPy5bY29sbGVjdGlvbi5zbHVnXT8ucmVhZD8ucGVybWlzc2lvbiAmJlxuICAgICAgY29sbGVjdGlvbj8uYWRtaW4/LmVuYWJsZVJpY2hUZXh0UmVsYXRpb25zaGlwXG4gICAgKSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICB7XG4gICAgICAgICAgbGFiZWw6IGNvbGxlY3Rpb24ubGFiZWxzLnBsdXJhbCxcbiAgICAgICAgICB2YWx1ZTogY29sbGVjdGlvbi5zbHVnLFxuICAgICAgICB9LFxuICAgICAgXVxuICAgIH1cblxuICAgIHJldHVybiBvcHRpb25zXG4gIH0sIFtdKVxuXG5jb25zdCBSZWxhdGlvbnNoaXBGaWVsZHMgPSAoKSA9PiB7XG4gIGNvbnN0IHsgY29sbGVjdGlvbnMgfSA9IHVzZUNvbmZpZygpXG4gIGNvbnN0IHsgcGVybWlzc2lvbnMgfSA9IHVzZUF1dGgoKVxuICBjb25zdCB7IHQgfSA9IHVzZVRyYW5zbGF0aW9uKCdmaWVsZHMnKVxuXG4gIGNvbnN0IFtvcHRpb25zLCBzZXRPcHRpb25zXSA9IHVzZVN0YXRlKCgpID0+IGNyZWF0ZU9wdGlvbnMoY29sbGVjdGlvbnMsIHBlcm1pc3Npb25zKSlcbiAgY29uc3QgcmVsYXRpb25UbyA9IHVzZUZvcm1GaWVsZHM8c3RyaW5nPigoW2ZpZWxkc10pID0+IGZpZWxkcy5yZWxhdGlvblRvPy52YWx1ZSBhcyBzdHJpbmcpXG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBzZXRPcHRpb25zKGNyZWF0ZU9wdGlvbnMoY29sbGVjdGlvbnMsIHBlcm1pc3Npb25zKSlcbiAgfSwgW2NvbGxlY3Rpb25zLCBwZXJtaXNzaW9uc10pXG5cbiAgcmV0dXJuIChcbiAgICA8RnJhZ21lbnQ+XG4gICAgICA8U2VsZWN0Q29tcG9uZW50IGxhYmVsPXt0KCdyZWxhdGlvblRvJyl9IG5hbWU9XCJyZWxhdGlvblRvXCIgb3B0aW9ucz17b3B0aW9uc30gcmVxdWlyZWQgLz5cbiAgICAgIHtyZWxhdGlvblRvICYmIChcbiAgICAgICAgPFJlbGF0aW9uc2hpcENvbXBvbmVudFxuICAgICAgICAgIGxhYmVsPXt0KCdyZWxhdGVkRG9jdW1lbnQnKX1cbiAgICAgICAgICBuYW1lPVwidmFsdWVcIlxuICAgICAgICAgIHJlbGF0aW9uVG89e3JlbGF0aW9uVG99XG4gICAgICAgICAgcmVxdWlyZWRcbiAgICAgICAgLz5cbiAgICAgICl9XG4gICAgPC9GcmFnbWVudD5cbiAgKVxufVxuXG5leHBvcnQgZGVmYXVsdCBSZWxhdGlvbnNoaXBGaWVsZHNcbiJdLCJuYW1lcyI6WyJjcmVhdGVPcHRpb25zIiwiY29sbGVjdGlvbnMiLCJwZXJtaXNzaW9ucyIsInJlZHVjZSIsIm9wdGlvbnMiLCJjb2xsZWN0aW9uIiwic2x1ZyIsInJlYWQiLCJwZXJtaXNzaW9uIiwiYWRtaW4iLCJlbmFibGVSaWNoVGV4dFJlbGF0aW9uc2hpcCIsImxhYmVsIiwibGFiZWxzIiwicGx1cmFsIiwidmFsdWUiLCJSZWxhdGlvbnNoaXBGaWVsZHMiLCJ1c2VDb25maWciLCJ1c2VBdXRoIiwidCIsInVzZVRyYW5zbGF0aW9uIiwic2V0T3B0aW9ucyIsInVzZVN0YXRlIiwicmVsYXRpb25UbyIsInVzZUZvcm1GaWVsZHMiLCJmaWVsZHMiLCJ1c2VFZmZlY3QiLCJGcmFnbWVudCIsIlNlbGVjdENvbXBvbmVudCIsIm5hbWUiLCJyZXF1aXJlZCIsIlJlbGF0aW9uc2hpcENvbXBvbmVudCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OytCQXNEQTs7O2VBQUE7Ozs4QkFwRHNDO3dCQUNOO3VCQUNGOzJCQUNLOytEQUNrQjs4QkFDdEI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUUvQixNQUFNQSxnQkFBZ0IsQ0FBQ0MsYUFBYUMsY0FDbENELFlBQVlFLE1BQU0sQ0FBQyxDQUFDQyxTQUFTQztRQUMzQixJQUNFSCxhQUFhRCxhQUFhLENBQUNJLFdBQVdDLElBQUksQ0FBQyxFQUFFQyxNQUFNQyxjQUNuREgsWUFBWUksT0FBT0MsNEJBQ25CO1lBQ0EsT0FBTzttQkFDRk47Z0JBQ0g7b0JBQ0VPLE9BQU9OLFdBQVdPLE1BQU0sQ0FBQ0MsTUFBTTtvQkFDL0JDLE9BQU9ULFdBQVdDLElBQUk7Z0JBQ3hCO2FBQ0Q7UUFDSDtRQUVBLE9BQU9GO0lBQ1QsR0FBRyxFQUFFO0FBRVAsTUFBTVcscUJBQXFCO0lBQ3pCLE1BQU0sRUFBRWQsV0FBVyxFQUFFLEdBQUdlLElBQUFBLG9CQUFTO0lBQ2pDLE1BQU0sRUFBRWQsV0FBVyxFQUFFLEdBQUdlLElBQUFBLGtCQUFPO0lBQy9CLE1BQU0sRUFBRUMsQ0FBQyxFQUFFLEdBQUdDLElBQUFBLDRCQUFjLEVBQUM7SUFFN0IsTUFBTSxDQUFDZixTQUFTZ0IsV0FBVyxHQUFHQyxJQUFBQSxlQUFRLEVBQUMsSUFBTXJCLGNBQWNDLGFBQWFDO0lBQ3hFLE1BQU1vQixhQUFhQyxJQUFBQSxvQkFBYSxFQUFTLENBQUMsQ0FBQ0MsT0FBTyxHQUFLQSxPQUFPRixVQUFVLEVBQUVSO0lBRTFFVyxJQUFBQSxnQkFBUyxFQUFDO1FBQ1JMLFdBQVdwQixjQUFjQyxhQUFhQztJQUN4QyxHQUFHO1FBQUNEO1FBQWFDO0tBQVk7SUFFN0IscUJBQ0UsNkJBQUN3QixlQUFRLHNCQUNQLDZCQUFDQyx1QkFBZTtRQUFDaEIsT0FBT08sRUFBRTtRQUFlVSxNQUFLO1FBQWF4QixTQUFTQTtRQUFTeUIsVUFBQUE7UUFDNUVQLDRCQUNDLDZCQUFDUSxtQ0FBcUI7UUFDcEJuQixPQUFPTyxFQUFFO1FBQ1RVLE1BQUs7UUFDTE4sWUFBWUE7UUFDWk8sVUFBQUE7O0FBS1Y7TUFFQSxXQUFlZCJ9